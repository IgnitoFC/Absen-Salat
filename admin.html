<!DOCTYPE html><html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Rekap Absensi</title><script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js"></script><style>
body {
  font-family: Arial, sans-serif;
  background: #f0f0f0;
  text-align: center;
}
table {
  width: 95%;
  margin: 20px auto;
  border-collapse: collapse;
  background: white;
}
th, td {
  padding: 10px;
  border: 1px solid #ddd;
}
th {
  background: #007bff;
  color: white;
}
h2 {
  margin-top: 20px;
}
</style></head>
<body><h2>Rekap Absensi Salat Dzuhur</h2><p id="tanggal"></p><table>
<thead>
<tr>
  <th>Nama</th>
  <th>Masuk</th>
  <th>Keluar</th>
  <th>Durasi</th>
</tr>
</thead>
<tbody id="tabel"></tbody>
</table><script>
// ISI CONFIG FIREBASE DI SINI
const firebaseConfig = {
  apiKey: "ISI",
  authDomain: "ISI",
  databaseURL: "ISI",
  projectId: "ISI",
  storageBucket: "ISI",
  messagingSenderId: "ISI",
  appId: "ISI"
};

const app = firebase.initializeApp(firebaseConfig);
const db = firebase.database();

function today() {
  let t = new Date();
  return `${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,'0')}-${String(t.getDate()).padStart(2,'0')}`;
}

document.getElementById("tanggal").innerHTML = "Tanggal: " + today();

const ref = firebase.database().ref("absen/" + today());

ref.on("value", snapshot => {
  let data = snapshot.val();
  let html = "";

  if (!data) {
    html = "<tr><td colspan='4'>Belum ada data</td></tr>";
    document.getElementById("tabel").innerHTML = html;
    return;
  }

  for (let uid in data) {
    let d = data[uid];

    // Hitung durasi (jika masuk & keluar lengkap)
    let durasi = "-";
    if (d.masuk && d.keluar) {
      let [h1,m1,s1] = d.masuk.split(":");
      let [h2,m2,s2] = d.keluar.split(":");
      let t1 = (+h1)*3600 + (+m1)*60 + (+s1);
      let t2 = (+h2)*3600 + (+m2)*60 + (+s2);
      let diff = t2 - t1;
      durasi = Math.floor(diff/60) + " menit";
    }

    html += `
      <tr>
        <td>${d.nama || "-"}</td>
        <td>${d.masuk || "-"}</td>
        <td>${d.keluar || "-"}</td>
        <td>${durasi}</td>
      </tr>
    `;
  }

  document.getElementById("tabel").innerHTML = html;
});
</script></body>
</html>
